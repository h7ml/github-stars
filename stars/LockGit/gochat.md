---
project: gochat
stars: 2881
description: goim server write by golang !ğŸš€
url: https://github.com/LockGit/gochat
---

ğŸš€ gochat
=========

### English version(è‹±æ–‡ç‰ˆæœ¬)

### æŒç»­å…³æ³¨

```
åˆ†äº«æ¶æ„è®¾è®¡ï¼Œç¼–ç¨‹è¯­è¨€ï¼Œç½‘ç»œå®‰å…¨ï¼Œé»‘å®¢æ–‡åŒ–ï¼Œäº’è”ç½‘è§é—»
```

### gochatæ˜¯ä¸€ä¸ªä½¿ç”¨çº¯goå®ç°çš„è½»é‡çº§imç³»ç»Ÿ

-   gochatä¸ºçº¯goå®ç°çš„å³æ—¶é€šè®¯ç³»ç»Ÿ,æ”¯æŒç§ä¿¡æ¶ˆæ¯ä¸æˆ¿é—´å¹¿æ’­æ¶ˆæ¯,å„å±‚ä¹‹é—´é€šè¿‡rpcé€šè®¯,æ”¯æŒæ°´å¹³æ‰©å±•ã€‚
-   æ”¯æŒwebsocket,tcpæ¥å…¥,å¹¶ä¸”åœ¨æœ€æ–°çš„ç‰ˆæœ¬ä¸­å·²ç»æ”¯æŒwebsocket,tcpæ¶ˆæ¯äº’é€šã€‚
-   å„å±‚ä¹‹é—´åŸºäºetcdæœåŠ¡å‘ç°,åœ¨æ‰©å®¹éƒ¨ç½²æ—¶å°†ä¼šæ–¹ä¾¿å¾ˆå¤šã€‚
-   ä½¿ç”¨redisä½œä¸ºæ¶ˆæ¯å­˜å‚¨ä¸æŠ•é€’çš„è½½ä½“,ååˆ†è½»é‡,åœ¨å®é™…åœºæ™¯ä¸­è¿˜å¯ä»¥æ›¿æ¢ä¸ºæ›´é‡çš„ç±»ä¼¼kafka,rabbitMQã€‚
-   ç”±äºgoçš„äº¤å‰ç¼–è¯‘ç‰¹æ€§,ç¼–è¯‘åå¯ä»¥å¿«é€Ÿåœ¨å„ä¸ªå¹³å°ä¸Šè¿è¡Œ,gochatæ¶æ„åŠç›®å½•ç»“æ„æ¸…æ™°ã€‚
-   æœ¬é¡¹ç›®è´´å¿ƒçš„æä¾›äº†dockerä¸€é”®æ„å»ºæ‰€æœ‰ç¯å¢ƒä¾èµ–,å®‰è£…èµ·æ¥ååˆ†ä¾¿æ·ã€‚(å¦‚æœæ˜¯ä½“éªŒï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨dockeræ„å»º)

### æ›´æ–°

-   2022å¹´08æœˆ06æ—¥
    -   è™½ç„¶UIåœ¨æœ¬ç³»ç»Ÿä¸­å¹¶ä¸æ˜¯å¾ˆé‡è¦ï¼Œä½†çœ‹ç€ç¡®å®åˆ«æ‰­ï¼Œç”¨TypeScript+Reactç³Šäº†ä¸€ä¸ªç¨å¾®çœ‹ä¸Šå»æ­£å¸¸ä¸€äº›çš„å‰ç«¯UIç•Œé¢ï¼ŒUIé¡¹ç›®åœ°å€ï¼šhttps://github.com/LockGit/gochat-ui
-   2022å¹´05æœˆ08æ—¥
    -   ç›®å‰golangç‰ˆæœ¬å‡çº§åˆ°äº†1.18ï¼Œå¦‚æœæœªä½¿ç”¨dockerï¼Œé€‰æ‹©è‡ªå·±ç¼–è¯‘å®‰è£…è¯·ç¡®ä¿è‡ªå·±çš„goç‰ˆæœ¬æ˜¯å¦ç¬¦åˆè¦æ±‚
    -   vendorä¹Ÿæ‰“åŒ…åˆ°äº†ä»“åº“é‡Œï¼ŒåŠ ä¸Švendoræ•´ä¸ªé¡¹ç›®å¤§å°çº¦66Mï¼Œç†è®ºgit cloneåå°±å°±å¯ä»¥ä½¿ç”¨ï¼Œç”±äºä¸å¯æŠ—æ‹’çš„ç½‘ç»œå› ç´ ï¼Œå¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´
    -   å‡çº§äº†ä¸€äº›åŒ…ä¾èµ–ç‰ˆæœ¬ï¼Œä¸å»ºè®®åœ¨ä½ç‰ˆæœ¬çš„golangä¸Šå°è¯•ç¼–è¯‘æœ¬é¡¹ç›®ï¼Œå°½é‡å‡çº§åˆ°1.18+
    -   ä¼˜åŒ–ï¼šwatch etcdçš„ä¸­å¯¹åº”çš„kvå˜åŒ–ï¼ŒåŠ¨æ€æ›´æ–°æœåŠ¡ipåœ°å€ï¼Œç¡®ä¿æ–°å¢/ç§»é™¤å„å±‚åå…¶ä»–å±‚èƒ½å¤Ÿæ„ŸçŸ¥

### Websocket && Tcpæ¶ˆæ¯äº’é€š

```
å…³äºæœ€æ–°ç‰ˆæœ¬æ”¯æŒæ”¯æŒwebsocket,tcpæ¶ˆæ¯äº’é€šéƒ¨åˆ†çš„è¯´æ˜ï¼š
tcpæ¶ˆæ¯æŠ•é€’ä¸æ¥æ”¶æµ‹è¯•ä»£ç åœ¨æœ¬é¡¹ç›®pkg/stickpackageç›®å½•ä¸­çš„:stickpackage_test.goæ–‡ä»¶ä¸­çš„Test_TcpClientæ–¹æ³•
å…¶ä¸­stickpackage.goæ–‡ä»¶ä¸»è¦ä¸ºå®ç°tcpæ‹†åŒ…è§£åŒ…æ—¶ç”¨åˆ°ï¼Œå¯ä»¥è¿½è¸ªä¸‹å…¶ä¸­Packä¸Unpackæ–¹æ³•çš„è°ƒç”¨åœ°æ–¹ã€‚
ä¸»è¦åŸå› æ˜¯tcpæ˜¯åŸºäºç¬¬4å±‚çš„æµå¼åè®®è€Œéåº”ç”¨å±‚åè®®ï¼Œæ‰€ä»¥æ‰æœ‰äº†è¿™ä¸ªè¿‡ç¨‹ã€‚
å¦‚æœæ˜¯androidï¼Œioså®¢æˆ·ç«¯æ¥é“¾æ¥ï¼Œé‚£ä¹ˆå¯¹åº”çš„å°±æ˜¯éœ€è¦ç”¨ç†Ÿæ‚‰çš„è¯­è¨€æ¥å®ç°è¿™ä¸ªtcpæ‹†åŒ…è§£åŒ…çš„è¿‡ç¨‹ï¼Œä¾‹å­ä¸­çš„ä»£ç æ˜¯golangå®ç°çš„demoã€‚
go test -v -count=1 *.go -test.run Test_TcpClient

å¦‚æœæ˜¯æµ‹è¯•tcpæ¶ˆæ¯æŠ•é€’:
åªéœ€è¦ä¿®æ”¹è¿™ä¸ªæ–¹æ³•ä¸­@todoéƒ¨åˆ†çš„å†…å®¹ä¸ºä½ æµ‹è¯•æ—¶æ­£ç¡®çš„å†…å®¹å³å¯,æµ‹è¯•tcpç«¯å£ä½¿ç”¨7001ï¼Œ7002ï¼Œå¦‚æœæ˜¯åœ¨ä¸ªäººvpsä¸Š,æ³¨æ„é…ç½®é˜²ç«å¢™æ”¾è¡Œç›¸å…³ç«¯å£ã€‚
authTokenä¸ºè¿›è¡Œtcpé“¾æ¥æ—¶çš„è®¤è¯tokenï¼Œè¿™ä¸ªtokenæ˜¯ç”¨æˆ·æ ‡è¯†ï¼Œåœ¨webä¸Šç™»å½•åçš„apiè¿”å›ä¸­å¯ä»¥çœ‹åˆ°jsonè¿”å›ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨redisä¸­å»æŸ¥åˆ°æŸä¸€ä¸ªç”¨æˆ·çš„tokenã€‚
æœåŠ¡ç«¯æ¥æ”¶åˆ°è¿™ä¸ªauthTokenæ—¶ä¼šæŠŠå¯¹åº”ç”¨æˆ·tcpé“¾æ¥ä¼šè¯åŠ å…¥åˆ°ç›¸åº”æˆ¿é—´çš„ä¼šè¯åŒå‘é“¾è¡¨ä¸­ã€‚

åŠ å…¥æ”¯æŒtcpå,å¦‚æœä¸€ä¸ªæˆ¿é—´ä¸­æ—¢æœ‰é€šè¿‡websocketè¿›è¡Œé“¾æ¥çš„ç”¨æˆ·ï¼Œåˆæœ‰é€šè¿‡tcpè¿›è¡Œé“¾æ¥çš„ç”¨æˆ·ï¼Œé‚£ä¹ˆæ¶ˆæ¯æŠ•é€’å¤§è‡´æµç¨‹ï¼š
1ï¼Œé¦–å…ˆç”¨æˆ·ç™»å½•ï¼Œæºå¸¦tokenï¼Œæˆ¿é—´å·å»è¿æ¥websocket,tcpæœåŠ¡ç«¯ï¼Œåœ¨é“¾æ¥å±‚å»ºç«‹é•¿é“¾æ¥ä¼šè¯ï¼Œ
æ¯”å¦‚ç”¨æˆ·Aåœ¨æˆ¿é—´1ï¼Œé€šè¿‡websocketé“¾æ¥ï¼Œç”¨æˆ·Bä¹Ÿåœ¨æˆ¿é—´1ï¼Œé€šè¿‡tcpé“¾æ¥ã€‚

2ï¼Œç”¨æˆ·å‘æˆ¿é—´å†…å‘é€æ¶ˆæ¯ï¼Œç›®å‰æ˜¯ç›´æ¥æŠŠæ¶ˆæ¯é€šè¿‡httpæŠ•åˆ°ç›¸åº”æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œ
è¿™ä¸ªåœ°æ–¹ï¼Œå…¶å®ä¹Ÿå¯ä»¥é€šè¿‡websocket,tcpæ¥å‘ï¼Œä¸è¿‡æœ€ç»ˆæ¶ˆæ¯éƒ½æ˜¯è¦è¿›é˜Ÿåˆ—çš„ã€‚

3ï¼Œtaskå±‚æ¶ˆè´¹é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œrpcå¹¿æ’­åˆ°websocketé“¾æ¥å±‚å’Œtcpé“¾æ¥å±‚çš„ç›¸åº”æˆ¿é—´ä¸­ï¼Œ
é“¾æ¥å±‚è·å¾—æ¶ˆæ¯åï¼ŒæŠŠæ¶ˆæ¯æŠ•é€’åˆ°å¯¹åº”çš„è¿œç«¯ç”¨æˆ·(ç›¸å½“äºéå†æˆ¿é—´ä¸­ç»´æŠ¤çš„ç”¨æˆ·é“¾æ¥ä¼šè¯åŒå‘é“¾è¡¨)
```

### æ¶æ„è®¾è®¡

### æœåŠ¡å‘ç°

### æ¶ˆæ¯æŠ•é€’

```
æ¶ˆæ¯å‘é€å¿…é¡»åœ¨ç™»å½•çŠ¶æ€ä¸‹,å¦‚ä¸Šå›¾,ç”¨æˆ·Aå‘ç”¨æˆ·Bå‘é€äº†ä¸€æ¡æ¶ˆæ¯ã€‚é‚£ä¹ˆç»å†äº†å¦‚ä¸‹å†ç¨‹ï¼š
1,ç”¨æˆ·Aè°ƒç”¨apiå±‚æ¥å£ç™»å½•ç³»ç»Ÿ,ç™»å½•æˆåŠŸåä¸connectå±‚è®¤è¯ä¿æŒé•¿é“¾æ¥,
å¹¶rpc call logicå±‚è®°å½•ç”¨æˆ·Aåœ¨connectå±‚ç™»å½•çš„serverId,é»˜è®¤åŠ å…¥æˆ¿é—´å·1

2,ç”¨æˆ·Bè°ƒç”¨apiå±‚æ¥å£ç™»å½•ç³»ç»Ÿ,ç™»å½•æˆåŠŸåä¸connectå±‚è®¤è¯ä¿æŒé•¿é“¾æ¥,
å¹¶rpc call logicå±‚è®°å½•ç”¨æˆ·Båœ¨connectå±‚ç™»å½•çš„serverId,é»˜è®¤åŠ å…¥æˆ¿é—´å·1

3,ç”¨æˆ·Aè°ƒç”¨apiå±‚æ¥å£å‘é€æ¶ˆæ¯,apiå±‚rpc call logicå±‚å‘é€æ¶ˆæ¯æ–¹æ³•,
logicå±‚å°†è¯¥æ¶ˆæ¯pushåˆ°é˜Ÿåˆ—ä¸­ç­‰å¾…taskå±‚æ¶ˆè´¹

4,taskå±‚è®¢é˜…logicå±‚å‘é€åˆ°é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å,
æ ¹æ®æ¶ˆæ¯å†…å®¹(userId,roomId,serverId)å¯ä»¥å®šä½ç”¨æˆ·Bç›®å‰åœ¨connectå±‚é‚£ä¸€ä¸ªserverIdä¸Šä¿æŒé•¿é“¾æ¥,
è¿›ä¸€æ­¥rpc call connectå±‚æ–¹æ³•

5,connectå±‚è¢«taskå±‚rpc callä¹‹å,ä¼šå°†è¯¥æ¶ˆæ¯æŠ•é€’åˆ°ç›¸å…³æˆ¿é—´å†…ï¼Œ
å†è¿›ä¸€æ­¥æŠ•é€’ç»™åœ¨è¯¥æˆ¿é—´å†…çš„ç”¨æˆ·B,å®Œæˆä¸€æ¬¡å®Œæ•´çš„æ¶ˆæ¯ä¼šè¯é€šè®¯

6,å¦‚æœæ˜¯ç§ä¿¡æ¶ˆæ¯,é‚£ä¹ˆtaskå±‚ä¼šæ ¹æ®userIdå®šä½connectå±‚å¯¹åº”çš„serverId,
ç›´æ¥rpc call è¯¥serverIdçš„connectå±‚ï¼Œå®Œæˆç§ä¿¡æ¶ˆæ¯æŠ•é€’ã€‚

å­¦ä¹ å…¶ä»–imç³»ç»Ÿï¼Œä¸ºäº†å‡å°‘é”çš„ç«äº‰,ä¼šåœ¨connectå±‚ä¼šåˆ’åˆ†bucket:
å¤§è‡´ä¼šåƒå¦‚ä¸‹ç»“æ„ï¼š
connectå±‚:
    bucket: (bucket,å‡å°‘é”ç«äº‰)
        room: (æˆ¿é—´)
            channel: (ç”¨æˆ·ä¼šè¯)
```

### æ—¶åºå›¾

### èŠå¤©å®¤é¢„è§ˆ

ç”¨TypeScript + React ç³Šäº†ä¸€ä¸ªç¨å¾®çœ‹ä¸Šå»æ­£å¸¸ä¸€äº›çš„å‰ç«¯UIï¼ŒUIé¡¹ç›®åœ°å€ï¼šhttps://github.com/LockGit/gochat-ui

### ç”¨æˆ·é•¿é“¾æ¥ä¼šè¯å†…éƒ¨ç»“æ„

### åˆ’åˆ†bucketå‡å°é”ç«äº‰

### åŸºäºCityHashè®©hashåˆ†å¸ƒçš„æ›´å‡åŒ€

### é“¾æ¥å±‚çš„å•ä¸ªserverå†…éƒ¨ç»“æ„é¢„è§ˆ

### ç®€å•å‹æµ‹

### ç›®å½•ç»“æ„

```
âœ  gochat git:(master) âœ— tree -L 1
.
â”œâ”€â”€ api                  # apiæ¥å£å±‚,æä¾›rest apiæœåŠ¡,ä¸»è¦rpc call logicå±‚æœåŠ¡,å¯æ°´å¹³æ‰©å±• 
â”œâ”€â”€ architecture         # æ¶æ„å›¾èµ„æºå›¾ç‰‡æ–‡ä»¶å¤¹
â”œâ”€â”€ bin                  # golangç¼–è¯‘åçš„äºŒè¿›åˆ¶æ–‡ä»¶,ä¸å‚ä¸æäº¤è‡³gitä»“åº“
â”œâ”€â”€ config               # é…ç½®æ–‡ä»¶
â”œâ”€â”€ connect              # é“¾æ¥å±‚,è¯¥å±‚ç”¨äºhandlerä½å¤§é‡ç”¨æˆ·é•¿è¿æ¥,å®æ—¶æ¶ˆæ¯æ¨é€,é™¤æ­¤ä¹‹å¤–,ä¸»è¦rpc call logicå±‚æœåŠ¡,å¯æ°´å¹³æ‰©å±•
â”œâ”€â”€ db                   # æ•°æ®åº“é“¾æ¥åˆå§‹åŒ–,å†…éƒ¨gochat.sqlite3ä¸ºæ–¹ä¾¿æ¼”ç¤ºæ—¶ä½¿ç”¨çš„sqliteæ•°æ®åº“,å®é™…åœºæ™¯å¯æ›¿æ¢ä¸ºå…¶ä»–å…³ç³»å‹æ•°æ®åº“
â”œâ”€â”€ docker               # ç”¨äºå¿«é€Ÿæ„å»ºdockerç¯å¢ƒ
â”œâ”€â”€ go.mod               # goåŒ…ç®¡ç†modæ–‡ä»¶
â”œâ”€â”€ go.sum               # goåŒ…ç®¡ç†sumæ–‡ä»¶
â”œâ”€â”€ logic                # é€»è¾‘å±‚,è¯¥å±‚ä¸»è¦æ¥æ”¶connectå±‚ä¸apiå±‚çš„rpcè¯·æ±‚ã€‚å¦‚æœæ˜¯æ¶ˆæ¯,ä¼špushåˆ°é˜Ÿåˆ—,æœ€ç»ˆè¢«taskå±‚æ¶ˆè´¹,å¯æ°´å¹³æ‰©å±•
â”œâ”€â”€ main.go              # gochatç¨‹åºå”¯ä¸€å…¥å£æ–‡ä»¶
â”œâ”€â”€ proto                # golang rpc proto æ–‡ä»¶
â”œâ”€â”€ readme.md            # ä¸­æ–‡è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ readme.en.md         # è‹±æ–‡è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ reload.sh            # ç¼–è¯‘gochatå¹¶æ‰§è¡Œsupervisorctl restarté‡å¯ç›¸å…³è¿›ç¨‹
â”œâ”€â”€ run.sh               # å¿«é€Ÿæ„å»ºä¸€ä¸ªdockerå®¹å™¨,å¯åŠ¨demo
â”œâ”€â”€ site                 # ç«™ç‚¹å±‚,è¯¥å±‚ä¸ºçº¯é™æ€é¡µé¢,ä¼šhttpè¯·æ±‚apiå±‚,å¯æ°´å¹³æ‰©å±•
â”œâ”€â”€ task                 # ä»»åŠ¡å±‚,è¯¥å±‚æ¶ˆè´¹é˜Ÿåˆ—ä¸­çš„æ•°æ®,å¹¶ä¸”rpc call connectå±‚æ‰§è¡Œæ¶ˆæ¯çš„å‘é€,å¯æ°´å¹³æ‰©å±•
â”œâ”€â”€ tools                # å·¥å…·æ–¹æ³•
â””â”€â”€ vendor               # vendoråŒ…
```

### ç›¸å…³ç»„ä»¶

```
è¯­è¨€ï¼šgolang

æ•°æ®åº“ï¼šsqlite3 
å¯ä»¥æ ¹æ®å®é™…ä¸šåŠ¡åœºæ™¯æ›¿æ¢æˆmysqlæˆ–è€…å…¶ä»–æ•°æ®åº“,
åœ¨æœ¬é¡¹ç›®ä¸­ä¸ºæ–¹ä¾¿æ¼”ç¤º,ä½¿ç”¨sqliteæ›¿ä»£å¤§å‹å…³ç³»å‹æ•°æ®åº“,ä»…å­˜å‚¨äº†ç®€å•ç”¨æˆ·ä¿¡æ¯

æ•°æ®åº“ORMï¼šgorm 

æœåŠ¡å‘ç°ï¼šetcd

rpcé€šè®¯ï¼šrpcx

é˜Ÿåˆ—:redis 
æ–¹ä¾¿æ¼”ç¤ºä½¿ç”¨redis,å¯ä»¥æ ¹æ®å®é™…æƒ…å†µæ›¿æ¢ä¸ºkafkaæˆ–è€…rabbitmq

ç¼“å­˜:redis 
å­˜å‚¨ç”¨æˆ·session,ä»¥åŠç›¸å…³è®¡æ•°å™¨,èŠå¤©å®¤æˆ¿é—´ä¿¡æ¯ç­‰

æ¶ˆæ¯id:
snowflakeIdç®—æ³•,æ­¤éƒ¨åˆ†å¯ä»¥å•ç‹¬æ‹†åˆ†æˆå¾®æœåŠ¡,ä½¿å…¶æˆä¸ºåŸºç¡€æœåŠ¡çš„ä¸€éƒ¨åˆ†ã€‚
è¯¥idå‘å·å™¨qpsç†è®ºæœ€é«˜409.6w/s,äº’è”ç½‘ä¸Šæ²¡æœ‰å“ªä¸€å®¶å…¬å¸å¯ä»¥è¾¾åˆ°è¿™ä¹ˆé«˜çš„å¹¶å‘,é™¤éé­å—DDOSæ”»å‡»
```

### æ•°æ®åº“åŠè¡¨ç»“æ„

```
åœ¨æœ¬demoä¸­,ä¸ºäº†è¶³å¤Ÿè½»é‡æ–¹ä¾¿æ¼”ç¤º,æ•°æ®åº“ä½¿ç”¨äº†sqlite3,åŸºäºgorm,æ‰€ä»¥è¿™ä¸ªæ˜¯å¯ä»¥æ›¿æ¢çš„ã€‚
å¦‚æœéœ€è¦æ›¿æ¢å…¶ä»–å…³ç³»å‹æ•°æ®åº“,ä»…ä»…åªéœ€è¦ä¿®æ”¹ç›¸å…³dbé©±åŠ¨å³å¯ã€‚

ç›¸å…³è¡¨ç»“æ„ï¼š
cd db && sqlite3 gochat.sqlite3
.tables
```

```
create table user(
                   `id` INTEGER PRIMARY KEY autoincrement , -- 'ç”¨æˆ·id'
                   `user_name` varchar(20) not null UNIQUE default '', -- 'ç”¨æˆ·å'
                   `password` char(40) not null default '', -- 'å¯†ç '
                   `create_time` timestamp NOT NULL DEFAULT current_timestamp -- 'åˆ›å»ºæ—¶é—´'
);
```

### å®‰è£…

```
åœ¨å¯åŠ¨å„å±‚ä¹‹å‰,è¯·ç¡®ä¿å·²ç»å¯åŠ¨äº†etcdä¸redisæœåŠ¡ä»¥åŠä»¥ä¸Šæ•°æ®åº“è¡¨,
å¹¶ç¡®ä¿ã€7000, 7070, 8080ã€‘ç«¯å£æ²¡æœ‰è¢«å ç”¨ã€‚ï¼ˆæµ‹è¯•tcpç«¯å£ä½¿ç”¨7001ï¼Œ7002ï¼Œå¦‚æœè¦ä½¿ç”¨tcp,é‚£ä¹ˆé˜²ç«å¢™ä¹Ÿéœ€è¦æ”¾è¡Œè¿™ä¸¤ä¸ªç«¯å£ï¼‰
ç„¶åæŒ‰ç…§ä»¥ä¸‹é¡ºåºå¯åŠ¨å„å±‚,å¦‚æœè¦æ‰©å®¹connectå±‚,
è¯·ç¡®ä¿connectå±‚é…ç½®ä¸­å„ä¸ªserverIdä¸ä¸€æ ·!

0,ç¼–è¯‘
go build -o gochat.bin -tags=etcd main.go

1,å¯åŠ¨logicå±‚
./gochat.bin -module logic

2,å¯åŠ¨connectå±‚
./gochat.bin -module connect_tcp
æˆ–è€…  
./gochat.bin -module connect_websocket

3,å¯åŠ¨taskå±‚
./gochat.bin -module task

4,å¯åŠ¨apiå±‚
./gochat.bin -module api 

5,å¯åŠ¨ä¸€ä¸ªç«™ç‚¹,å¼€å§‹èŠå¤©å®¤
./gochat.bin -module site
```

### ä½¿ç”¨dockerä¸€é”®å¯åŠ¨

#### ä½¿ç”¨ç°æœ‰é•œåƒ

amd x86æ¶æ„

```
å¦‚æœä½ è§‰å¾—ä»¥ä¸Šæ­¥éª¤è¿‡äºç¹ç,ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹dockeré•œåƒæ„å»ºæ‰€æœ‰ä¾èµ–ç¯å¢ƒå¹¶å¿«é€Ÿå¯åŠ¨ä¸€ä¸ªèŠå¤©å®¤
æ‰§è¡Œdockerç›¸å…³æ­¥éª¤çš„æ—¶å€™,ä¼šåˆ°hub.docker.comæ‹‰å–ç›¸å…³é•œåƒ,å¯èƒ½éœ€è¦ç¿»å¢™,å…·ä½“çœ‹ä½ çš„ç½‘ç»œã€‚

ä½ å¯ä»¥ä½¿ç”¨æˆ‘æ¨åˆ°docker hubä¸Šçš„é•œåƒ:
é»˜è®¤é•œåƒä¸­å·²ç»åˆ›å»ºäº†å‡ ä¸ªæµ‹è¯•ç”¨æˆ·ï¼š
ç”¨æˆ·å,å¯†ç 
demo  111111
test  111111
admin 111111
1,docker pull lockgit/gochat:1.18 (ç›®å‰ä½¿ç”¨çš„æ˜¯1.18ç‰ˆæœ¬)
2,git clone git@github.com:LockGit/gochat.git
3,cd gochat && sh run.sh dev 127.0.0.1 (è¯¥æ­¥éª¤éœ€è¦ä¸€å®šæ—¶é—´ç¼–è¯‘å„ä¸ªæ¨¡å—ï¼Œè€å¿ƒç­‰å¾…å³å¯,éƒ¨åˆ†ç³»ç»Ÿå¯èƒ½æ²¡æœ‰sh,å¦‚æœæ‰§è¡ŒæŠ¥é”™,æŠŠsh run.sh devæ”¹ä¸º./run.sh dev 127.0.0.1æ‰§è¡Œï¼‰
4,è®¿é—® http://127.0.0.1:8080/login è¾“å…¥ç”¨æˆ·å/å¯†ç ä»¥è®¿é—®èŠå¤©å®¤
5,è®¿é—® http://127.0.0.1:8080 å¼€å¯èŠå¤©å®¤
```

#### æ„å»ºæ–°é•œåƒ

```
å¦‚æœä½ æƒ³è‡ªå·±æ„å»ºä¸€ä¸ªé•œåƒ,é‚£ä¹ˆåªéœ€è¦build dockeræ–‡ä»¶ä¸‹çš„Dockerfile
make build TAG=1.18(è¿™é‡Œçš„1.18å°±æ˜¯run.shä¸­çš„é•œåƒç”¨åˆ°çš„ç‰ˆæœ¬ï¼‰
ä¸Šé¢buildè¿‡ç¨‹å¯èƒ½éœ€è¦ç¿»å¢™ä¸”éœ€è¦ä¸€å®šæ—¶é—´ï¼Œå®Œæˆåæ‰§è¡Œ:
1,git clone git@github.com:LockGit/gochat.git
2,cd gochat && sh run.sh dev 127.0.0.1 (è¯¥æ­¥éª¤éœ€è¦ä¸€å®šæ—¶é—´ç¼–è¯‘å„ä¸ªæ¨¡å—ï¼Œè€å¿ƒç­‰å¾…å³å¯,éƒ¨åˆ†ç³»ç»Ÿå¯èƒ½æ²¡æœ‰sh,å¦‚æœæ‰§è¡ŒæŠ¥é”™,æŠŠsh run.sh devæ”¹ä¸º./run.sh dev 127.0.0.1æ‰§è¡Œï¼‰
3,è®¿é—® http://127.0.0.1:8080/login è¾“å…¥ç”¨æˆ·å/å¯†ç ä»¥è®¿é—®èŠå¤©å®¤
4,è®¿é—® http://127.0.0.1:8080 å¼€å¯èŠå¤©å®¤

å¦‚æœä½ è¦éƒ¨ç½²åœ¨ä¸ªäººvpsç­‰å…¬ç½‘ä¸Šï¼Œè®©åˆ«äººä¹Ÿèƒ½è®¿é—®ä½¿ç”¨ï¼Œæ‰§è¡Œ ï¼ˆsh run.sh dev éœ€è¦æš´éœ²çš„å…¬ç½‘ipåœ°å€ï¼‰å³å¯
å¹¶ç¡®ä¿vpsä¸Šæ²¡æœ‰é’ˆå¯¹ç›¸å…³ç«¯å£çš„é˜²ç«å¢™é™åˆ¶ã€‚
```

### è¿™é‡Œæä¾›ä¸€ä¸ªåœ¨çº¿èŠå¤©demoç«™ç‚¹ï¼š

http://45.77.108.245:8080

```
ç”¨ä»¥ä¸Šç”¨æˆ·åå¯†ç ç™»å½•å³å¯,ä¹Ÿå¯ä»¥è‡ªå·±æ³¨å†Œä¸€ä¸ªã€‚å¦‚æœæ— æ³•è®¿é—®äº†ï¼Œè¯·ä½¿ç”¨ä»¥ä¸Šdockeråœ¨æœ¬åœ°æ„å»ºä½“éªŒã€‚
å¯ç”¨ä¸åŒçš„è´¦å·åœ¨ä¸åŒçš„æµè§ˆå™¨ç™»å½•,å¦‚æœæ˜¯Chrome,å¯ç”¨ä»¥éšèº«æ¨¡å¼å¤šå¯åŠ¨å‡ ä¸ªæµè§ˆå™¨åˆ†åˆ«ä»¥ä¸åŒè´¦å·ç™»å½•,
ç„¶å,ä½“éªŒä¸åŒè´¦å·ä¹‹é—´èŠå¤©ä»¥åŠæ¶ˆæ¯æŠ•é€’æ•ˆæœã€‚(æ³¨:æœ¬demoæœªå¼€å¯tcpçš„é€šé“)
```

å¦‚æœæƒ³éƒ¨ç½²ç±»ä¼¼çš„ç§äººimèŠå¤©æœåŠ¡åˆ°å…¬ç½‘ä½“éªŒï¼Œä¹Ÿå¯åœ¨vulträ¸Šæ³¨å†Œè´¦å·è´­ä¹°ä¸€ä¸ªvpsä¸»æœºï¼Œéƒ¨ç½²imæœåŠ¡ä½“éªŒï¼š https://www.vultr.com/?ref=8981750-8H

### ç›¸å…³é—®é¢˜è§£ç­”

```
æ•´ç†å‡ºäº†å‡ ä¸ªè®¨è®ºæ¯”è¾ƒå¤šçš„é—®é¢˜:
1ï¼Œåœ¨å‘é€æ¶ˆæ¯çš„æ—¶å€™æ˜¯é€šè¿‡http,ä¸ºä»€ä¹ˆä¸æ˜¯websocket?
è¿™æ˜¯server demo im,å®Œå…¨å¯ä»¥é€šè¿‡websocketæ¥å‘é€ï¼Œæ•ˆæœä¸€æ ·ï¼ŒæŠŠç›¸å…³é€»è¾‘å¤„ç†æ”¾åˆ°websocketé‡Œå³å¯ï¼Œç›®å‰çš„æ¶ˆæ¯é€šè¿‡httpå‘é€åä¹Ÿæ˜¯rpc callåé¢çš„é“¾æ¥å±‚è¿›å…¥é˜Ÿåˆ—

2ï¼Œæ¶ˆæ¯æ˜¯å¦å­˜å‚¨æ•°æ®åº“?
æ²¡æœ‰å­˜å‚¨ï¼Œæ¶ˆæ¯ç›®å‰ä»…ä»…æ˜¯åœ¨é˜Ÿåˆ—é‡Œæµäº†ä¸€éåæŠ•é€’å‡ºå»ï¼Œå¯ä»¥è‡ªå·±åŠ å­˜å‚¨é€»è¾‘
```

### åç»­

```
gochatå®ç°äº†ç®€å•èŠå¤©å®¤åŠŸèƒ½,ç”±äºç²¾åŠ›æœ‰é™,ä½ å¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šä½¿ç”¨è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘å®šåˆ¶ä¸€äº›éœ€æ±‚,å¹¶ä¼˜æ‰ä¸€äº›gochatä¸­çš„ä»£ç ã€‚
ä½¿ç”¨ä¸­çš„ä»»ä½•é—®é¢˜è¯·æç›¸å…³issue,åç»­ä¼šæ ¹æ®å®é™…æƒ…å†µå®Œå–„å’Œä¼˜åŒ–ç›¸å…³ä»£ç ä¸è®¾è®¡ã€‚
```

### Backer and Sponsor

> jetbrains

```
jetbrainsæœ‰ä¸€é¡¹å¼€æºèµåŠ©è®¡åˆ’ï¼Œå¯ä»¥é€šè¿‡å¼€æºé¡¹ç›®å…è´¹ç”³è¯·jetbrainså…¨å®¶æ¡¶license
jetbraninså®˜æ–¹åœ¨èµ é€licenseçš„æ—¶å€™ä¼šè¯·æ±‚æè®®åŠ å…¥ä»–ä»¬çš„å“ç‰Œlogoæ¨å¹¿æ”¾å…¥åˆ°ä»“åº“ä¸­,
ä¸è¿‡è¿™ä¸€åˆ‡éƒ½æ˜¯ç”¨æˆ·è‡ªæ„¿çš„åŸåˆ™
```

### Support gochat

```
æ‚¨çš„æ”¯æŒä¹Ÿæ˜¯ä¸€ç§è‚¯å®šï¼Œå¦‚æœæ‚¨è§‰å¾—æœ‰å¸®åŠ©ä¹Ÿå¯ä»¥é€šè¿‡æ‰«æä¸‹é¢çš„å¾®ä¿¡äºŒç»´ç æ”¯æŒä½œè€…ç»§ç»­ä¼˜åŒ–å’Œå®Œå–„gochat
```

### License

gochat is licensed under the MIT License.

### Star History
