---
project: Vite-Vue3-TypeScript
stars: 9
description: ğŸ²ä¸€å¥—è§„èŒƒçš„ Vite + Vue3 + TypeScript å‰ç«¯å·¥ç¨‹åŒ–é¡¹ç›®ç¯å¢ƒ
url: https://github.com/webVueBlog/Vite-Vue3-TypeScript
---

Vite-Vue3-TypeScript
====================

-   æ¶æ„æ­å»º
-   ä»£ç è§„èŒƒ
-   æäº¤è§„èŒƒ
-   å•å…ƒæµ‹è¯•
-   è‡ªåŠ¨éƒ¨ç½²

ä¸€å¥—è§„èŒƒçš„ Vite + Vue3 + TypeScript å‰ç«¯å·¥ç¨‹åŒ–é¡¹ç›®ç¯å¢ƒ

æŠ€æœ¯æ ˆ
---

-   ç¼–ç¨‹è¯­è¨€ï¼šTypeScript 4.x + JavaScript
-   æ„å»ºå·¥å…·ï¼šVite 2.x
-   å‰ç«¯æ¡†æ¶ï¼šVue 3.x
-   è·¯ç”±å·¥å…·ï¼šVue Router 4.x
-   çŠ¶æ€ç®¡ç†ï¼šVuex 4.x
-   UI æ¡†æ¶ï¼šElement Plus
-   CSS é¢„ç¼–è¯‘ï¼šStylus / Sass / Less
-   HTTP å·¥å…·ï¼šAxios
-   Git Hook å·¥å…·ï¼šhusky + lint-staged
-   ä»£ç è§„èŒƒï¼šEditorConfig + Prettier + ESLint + Airbnb JavaScript Style Guide
-   æäº¤è§„èŒƒï¼šCommitizen + Commitlint
-   å•å…ƒæµ‹è¯•ï¼švue-test-utils + jest + vue-jest + ts-jest
-   è‡ªåŠ¨éƒ¨ç½²ï¼šGitHub Actions

æ¶æ„æ­å»º
----

è¯·ç¡®ä¿ä½ çš„ç”µè„‘ä¸ŠæˆåŠŸå®‰è£… Node.jsï¼Œæœ¬é¡¹ç›®ä½¿ç”¨ Vite æ„å»ºå·¥å…·ï¼Œéœ€è¦ Node.js ç‰ˆæœ¬ >= 12.0.0ã€‚

æŸ¥çœ‹ Node.js ç‰ˆæœ¬ï¼š

node \-v
// v14.17.3

### ä½¿ç”¨ Vite å¿«é€Ÿåˆå§‹åŒ–é¡¹ç›®é›å½¢

ä½¿ç”¨ NPMï¼š

npm init @vitejs/app

å¤åˆ¶ä»£ç 

ä½¿ç”¨ Yarnï¼š

yarn create @vitejs/app

vue \--version
@vue/cli 4.5.13

æ­å»ºç¬¬ä¸€ä¸ª Vite é¡¹ç›®
-------------

ä½¿ç”¨ NPM:

$ npm create vite@latest

ä½¿ç”¨ Yarn:

$ yarn create vite

ä½¿ç”¨ PNPM:

$ pnpm create vite

ç„¶åæŒ‰ç…§æç¤ºæ“ä½œå³å¯ï¼

1.  è¾“å…¥é¡¹ç›®åç§°

ä¾‹å¦‚ï¼šæœ¬é¡¹ç›®åç§° Vite-Vue3-TypeScript

1.  é€‰æ‹©æ¨¡æ¿

æœ¬é¡¹ç›®éœ€è¦ä½¿ç”¨ Vue3 + TypeScriptï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹© vue-tsï¼Œä¼šè‡ªåŠ¨å®‰è£… Vue3 å’Œ TypeScriptã€‚

ä½ è¿˜å¯ä»¥é€šè¿‡é™„åŠ çš„å‘½ä»¤è¡Œé€‰é¡¹ç›´æ¥æŒ‡å®šé¡¹ç›®åå’Œæ¨¡æ¿ï¼Œæœ¬é¡¹ç›®è¦æ„å»º Vite + Vue3 + TypeScript é¡¹ç›®ï¼Œåˆ™è¿è¡Œï¼š

\# npm 6.x
npm init @vitejs/app vite\-vue3\-starter \--template vue\-ts

# npm 7+ï¼ˆéœ€è¦é¢å¤–çš„åŒæ¨ªçº¿ï¼‰
npm init @vitejs/app vite\-vue3\-starter \-- \--template vue\-ts

# yarn
yarn create @vitejs/app vite\-vue3\-starter \--template vue\-ts

1.  å®‰è£…ä¾èµ–

npm install

1.  å¯åŠ¨é¡¹ç›®

npm run dev

æˆªå›¾
--

)

å¦‚ä¸Šå›¾ï¼Œè¡¨ç¤º Vite + Vue3 + TypeScript ç®€å•çš„é¡¹ç›®éª¨æ¶æ­å»ºå®Œæ¯•ï¼Œä¸‹é¢æˆ‘ä»¬æ¥ä¸ºè¿™ä¸ªé¡¹ç›®é›†æˆ Vue Routerã€Vuexã€Element Plusã€Axiosã€Stylus/Sass/Lessã€‚

ä¿®æ”¹ Vite é…ç½®æ–‡ä»¶
------------

Vite é…ç½®æ–‡ä»¶ vite.config.ts ä½äºæ ¹ç›®å½•ä¸‹ï¼Œé¡¹ç›®å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨è¯»å–ã€‚

æœ¬é¡¹ç›®å…ˆåšä¸€äº›ç®€å•é…ç½®ï¼Œä¾‹å¦‚ï¼šè®¾ç½® @ æŒ‡å‘ src ç›®å½•ã€ æœåŠ¡å¯åŠ¨ç«¯å£ã€æ‰“åŒ…è·¯å¾„ã€ä»£ç†ç­‰ã€‚

è§„èŒƒç›®å½•ç»“æ„
------

â”œâ”€â”€ publish/
â””â”€â”€ src/
    â”œâ”€â”€ assets/                    // é™æ€èµ„æºç›®å½•
    â”œâ”€â”€ common/                    // é€šç”¨ç±»åº“ç›®å½•
    â”œâ”€â”€ components/                // å…¬å…±ç»„ä»¶ç›®å½•
    â”œâ”€â”€ router/                    // è·¯ç”±é…ç½®ç›®å½•
    â”œâ”€â”€ store/                     // çŠ¶æ€ç®¡ç†ç›®å½•
    â”œâ”€â”€ style/                     // é€šç”¨ CSS ç›®å½•
    â”œâ”€â”€ utils/                     // å·¥å…·å‡½æ•°ç›®å½•
    â”œâ”€â”€ views/                     // é¡µé¢ç»„ä»¶ç›®å½•
    â”œâ”€â”€ App.vue
    â”œâ”€â”€ main.ts
    â”œâ”€â”€ shims\-vue.d.ts
â”œâ”€â”€ tests/                         // å•å…ƒæµ‹è¯•ç›®å½•
â”œâ”€â”€ index.html
â”œâ”€â”€ tsconfig.json                  // TypeScript é…ç½®æ–‡ä»¶
â”œâ”€â”€ vite.config.ts                 // Vite é…ç½®æ–‡ä»¶
â””â”€â”€ package.json

é›†æˆè·¯ç”±å·¥å…· Vue Router
-----------------

1.  å®‰è£…æ”¯æŒ Vue3 çš„è·¯ç”±å·¥å…· vue-router@4

npm i vue\-router@4

1.  åˆ›å»º src/router/index.ts æ–‡ä»¶
    
2.  åœ¨ main.ts æ–‡ä»¶ä¸­æŒ‚è½½è·¯ç”±é…ç½®
    

é›†æˆçŠ¶æ€ç®¡ç†å·¥å…· Vuex
-------------

1.  å®‰è£…æ”¯æŒ Vue3 çš„çŠ¶æ€ç®¡ç†å·¥å…· vuex@next

npm i vuex@next

1.  åˆ›å»º src/store/index.ts æ–‡ä»¶
    
2.  åœ¨ main.ts æ–‡ä»¶ä¸­æŒ‚è½½ Vuex é…ç½®
    

é›†æˆ UI æ¡†æ¶ Element Plus
---------------------

1.  å®‰è£…æ”¯æŒ Vue3 çš„ UI æ¡†æ¶ Element Plus

npm i element\-plus

1.  åœ¨ main.ts æ–‡ä»¶ä¸­æŒ‚è½½ Element Plus

é›†æˆ HTTP å·¥å…· Axios
----------------

1.  å®‰è£… Axiosï¼ˆAxios è·Ÿ Vue ç‰ˆæœ¬æ²¡æœ‰ç›´æ¥å…³ç³»ï¼Œå®‰è£…æœ€æ–°å³å¯ï¼‰

npm i axios

é›†æˆ CSS é¢„ç¼–è¯‘å™¨ Stylus/Sass/Less
----------------------------

æœ¬é¡¹ç›®ä½¿ç”¨ CSS é¢„ç¼–è¯‘å™¨ Stylusï¼Œç›´æ¥å®‰è£…ä¸ºå¼€å‘ä¾èµ–å³å¯ã€‚Vite å†…éƒ¨å·²å¸®æˆ‘ä»¬é›†æˆäº†ç›¸å…³çš„ loaderï¼Œä¸éœ€è¦é¢å¤–é…ç½®ã€‚åŒç†ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ Sass æˆ– Less ç­‰ã€‚

1.  å®‰è£…

npm i stylus \-D
# or
npm i sass \-D
npm i less \-D

è‡³æ­¤ï¼Œä¸€ä¸ªåŸºäº TypeScript + Vite + Vue3 + Vue Router + Vuex + Element Plus + Axios + Stylus/Sass/Less çš„å‰ç«¯é¡¹ç›®å¼€å‘ç¯å¢ƒæ­å»ºå®Œæ¯•

é¡¹ç›®é›†åˆäº†Stylus/Sass/Lessç­‰ï¼Œå¦‚åªæ˜¯éœ€è¦Sassï¼Œå¯ä»¥åœ¨ä¾èµ–ä¸­åˆ é™¤ï¼Œåªå…¶å®ƒä¾èµ–ï¼Œç„¶åä½¿ç”¨ yarn install

æ‰“ç£¨è¿™ä¸ªé¡¹ç›®
------

å¢åŠ ä»£ç è§„èŒƒçº¦æŸã€æäº¤è§„èŒƒçº¦æŸã€å•å…ƒæµ‹è¯•ã€è‡ªåŠ¨éƒ¨ç½²ç­‰ï¼Œè®©å…¶æ›´å®Œå–„ã€æ›´å¥å£®ã€‚

ä»£ç è§„èŒƒ
----

éšç€å‰ç«¯åº”ç”¨é€æ¸å˜å¾—å¤§å‹åŒ–å’Œå¤æ‚åŒ–ï¼Œåœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­æœ‰å¤šä¸ªäººå‘˜å‚ä¸æ—¶ï¼Œæ¯ä¸ªäººçš„å‰ç«¯èƒ½åŠ›ç¨‹åº¦ä¸ç­‰ï¼Œä»–ä»¬å¾€å¾€ä¼šç”¨ä¸åŒçš„ç¼–ç é£æ ¼å’Œä¹ æƒ¯åœ¨é¡¹ç›®ä¸­å†™ä»£ç ï¼Œé•¿æ­¤ä¸‹å»ï¼ŒåŠ¿å¿…ä¼šè®©é¡¹ç›®çš„å¥å£®æ€§è¶Šæ¥è¶Šå·®ã€‚è§£å†³è¿™äº›é—®é¢˜ï¼Œç†è®ºä¸Šè®²ï¼Œå£å¤´çº¦å®šå’Œä»£ç å®¡æŸ¥éƒ½å¯ä»¥ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼æ— æ³•å®æ—¶åé¦ˆï¼Œè€Œä¸”æ²Ÿé€šæˆæœ¬è¿‡é«˜ï¼Œä¸å¤Ÿçµæ´»ï¼Œæ›´å…³é”®çš„æ˜¯æ— æ³•æŠŠæ§ã€‚ä¸ä»¥è§„çŸ©ï¼Œä¸èƒ½æˆæ–¹åœ†ï¼Œæˆ‘ä»¬ä¸å¾—ä¸åœ¨é¡¹ç›®ä½¿ç”¨ä¸€äº›å·¥å…·æ¥çº¦æŸä»£ç è§„èŒƒã€‚

æœ¬æ–‡è®²è§£å¦‚ä½•ä½¿ç”¨ EditorConfig + Prettier + ESLint ç»„åˆæ¥å®ç°ä»£ç è§„èŒƒåŒ–ã€‚

è¿™æ ·åšå¸¦æ¥å¥½å¤„ï¼š
--------

1.  è§£å†³å›¢é˜Ÿä¹‹é—´ä»£ç ä¸è§„èŒƒå¯¼è‡´çš„å¯è¯»æ€§å·®å’Œå¯ç»´æŠ¤æ€§å·®çš„é—®é¢˜ã€‚
2.  è§£å†³å›¢é˜Ÿæˆå‘˜ä¸åŒç¼–è¾‘å™¨å¯¼è‡´çš„ç¼–ç è§„èŒƒä¸ç»Ÿä¸€é—®é¢˜ã€‚
3.  æå‰å‘ç°ä»£ç é£æ ¼é—®é¢˜ï¼Œç»™å‡ºå¯¹åº”è§„èŒƒæç¤ºï¼ŒåŠæ—¶ä¿®å¤ã€‚
4.  å‡å°‘ä»£ç å®¡æŸ¥è¿‡ç¨‹ä¸­ååå¤å¤çš„ä¿®æ”¹è¿‡ç¨‹ï¼ŒèŠ‚çº¦æ—¶é—´ã€‚
5.  è‡ªåŠ¨æ ¼å¼åŒ–ï¼Œç»Ÿä¸€ç¼–ç é£æ ¼ï¼Œä»æ­¤å’Œè„ä¹±å·®çš„ä»£ç è¯´å†è§ã€‚

é›†æˆ EditorConfig é…ç½®
------------------

EditorConfig æœ‰åŠ©äºä¸ºä¸åŒ IDE ç¼–è¾‘å™¨ä¸Šå¤„ç†åŒä¸€é¡¹ç›®çš„å¤šä¸ªå¼€å‘äººå‘˜ç»´æŠ¤ä¸€è‡´çš„ç¼–ç é£æ ¼ã€‚

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹å¢åŠ  .editorconfig æ–‡ä»¶ï¼š

VSCode ä½¿ç”¨ EditorConfig éœ€è¦å»æ’ä»¶å¸‚åœºä¸‹è½½æ’ä»¶ EditorConfig for VS Code ã€‚

é›†æˆ Prettier é…ç½®
--------------

Prettier æ˜¯ä¸€æ¬¾å¼ºå¤§çš„ä»£ç æ ¼å¼åŒ–å·¥å…·ï¼Œæ”¯æŒ JavaScriptã€TypeScriptã€CSSã€SCSSã€Lessã€JSXã€Angularã€Vueã€GraphQLã€JSONã€Markdown ç­‰è¯­è¨€ï¼ŒåŸºæœ¬ä¸Šå‰ç«¯èƒ½ç”¨åˆ°çš„æ–‡ä»¶æ ¼å¼å®ƒéƒ½å¯ä»¥æå®šï¼Œæ˜¯å½“ä¸‹æœ€æµè¡Œçš„ä»£ç æ ¼å¼åŒ–å·¥å…·ã€‚

1.  å®‰è£… Prettier

npm i prettier \-D

1.  åˆ›å»º Prettier é…ç½®æ–‡ä»¶
    
2.  é…ç½® .prettierrc
    
3.  Prettier å®‰è£…ä¸”é…ç½®å¥½ä¹‹åï¼Œå°±èƒ½ä½¿ç”¨å‘½ä»¤æ¥æ ¼å¼åŒ–ä»£ç 
    

\# æ ¼å¼åŒ–æ‰€æœ‰æ–‡ä»¶ï¼ˆ. è¡¨ç¤ºæ‰€æœ‰æ–‡ä»¶ï¼‰
npx prettier \--write .

VSCode ç¼–è¾‘å™¨ä½¿ç”¨ Prettier é…ç½®éœ€è¦ä¸‹è½½æ’ä»¶ Prettier - Code formatter ã€‚

é›†æˆ ESLint é…ç½®
------------

ESLint æ˜¯ä¸€æ¬¾ç”¨äºæŸ¥æ‰¾å¹¶æŠ¥å‘Šä»£ç ä¸­é—®é¢˜çš„å·¥å…·ï¼Œå¹¶ä¸”æ”¯æŒéƒ¨åˆ†é—®é¢˜è‡ªåŠ¨ä¿®å¤ã€‚å…¶æ ¸å¿ƒæ˜¯é€šè¿‡å¯¹ä»£ç è§£æå¾—åˆ°çš„ ASTï¼ˆAbstract Syntax Tree æŠ½è±¡è¯­æ³•æ ‘ï¼‰è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼Œæ¥åˆ†æä»£ç è¾¾åˆ°æ£€æŸ¥ä»£ç è´¨é‡å’Œé£æ ¼é—®é¢˜çš„èƒ½åŠ›ã€‚

1.  å®‰è£… ESLint (æ¨èæœ¬åœ°å®‰è£…ï¼Œåªåœ¨å½“å‰é¡¹ç›®ä¸­å®‰è£…)

npm i eslint \-D

1.  é…ç½® ESLint

ESLint å®‰è£…æˆåŠŸåï¼Œæ‰§è¡Œ npx eslint --initï¼Œç„¶åæŒ‰ç…§ç»ˆç«¯æ“ä½œæç¤ºå®Œæˆä¸€ç³»åˆ—è®¾ç½®æ¥åˆ›å»ºé…ç½®æ–‡ä»¶ã€‚

How would you like to use ESLint? ï¼ˆä½ æƒ³å¦‚ä½•ä½¿ç”¨ ESLint?ï¼‰

æˆ‘ä»¬è¿™é‡Œé€‰æ‹© To check syntax, find problems, and enforce code styleï¼ˆæ£€æŸ¥è¯­æ³•ã€å‘ç°é—®é¢˜å¹¶å¼ºåˆ¶æ‰§è¡Œä»£ç é£æ ¼ï¼‰

What type of modules does your project use?ï¼ˆä½ çš„é¡¹ç›®ä½¿ç”¨å“ªç§ç±»å‹çš„æ¨¡å—?ï¼‰

æˆ‘ä»¬è¿™é‡Œé€‰æ‹© JavaScript modules (import/export)

Which framework does your project use? ï¼ˆä½ çš„é¡¹ç›®ä½¿ç”¨å“ªç§æ¡†æ¶?ï¼‰

æˆ‘ä»¬è¿™é‡Œé€‰æ‹© Vue.js

Does your project use TypeScript?ï¼ˆä½ çš„é¡¹ç›®æ˜¯å¦ä½¿ç”¨ TypeScriptï¼Ÿï¼‰

æˆ‘ä»¬è¿™é‡Œé€‰æ‹© Yes

Where does your code run?ï¼ˆä½ çš„ä»£ç åœ¨å“ªé‡Œè¿è¡Œ?ï¼‰

æˆ‘ä»¬è¿™é‡Œé€‰æ‹© Browser å’Œ Nodeï¼ˆæŒ‰ç©ºæ ¼é”®è¿›è¡Œé€‰æ‹©ï¼Œé€‰å®ŒæŒ‰å›è½¦é”®ç¡®å®šï¼‰

How would you like to define a style for your project?ï¼ˆä½ æƒ³æ€æ ·ä¸ºä½ çš„é¡¹ç›®å®šä¹‰é£æ ¼ï¼Ÿï¼‰

æˆ‘ä»¬è¿™é‡Œé€‰æ‹© Use a popular style guideï¼ˆä½¿ç”¨ä¸€ç§æµè¡Œçš„é£æ ¼æŒ‡å—ï¼‰

Which style guide do you want to follow?ï¼ˆä½ æƒ³éµå¾ªå“ªä¸€ç§é£æ ¼æŒ‡å—?ï¼‰

æˆ‘ä»¬è¿™é‡Œé€‰æ‹©

ESLint ä¸ºæˆ‘ä»¬åˆ—å‡ºäº†ä¸‰ç§ç¤¾åŒºæµè¡Œçš„ JavaScript é£æ ¼æŒ‡å—ï¼Œåˆ†åˆ«æ˜¯ Airbnbã€Standardã€Googleã€‚

What format do you want your config file to be in?ï¼ˆä½ å¸Œæœ›ä½ çš„é…ç½®æ–‡ä»¶æ˜¯ä»€ä¹ˆæ ¼å¼?ï¼‰

æˆ‘ä»¬è¿™é‡Œé€‰æ‹© JavaScript

Would you like to install them now with npm?ï¼ˆä½ æƒ³ç°åœ¨å°±ç”¨ NPM å®‰è£…å®ƒä»¬å—?ï¼‰

æ ¹æ®ä¸Šé¢çš„é€‰æ‹©ï¼ŒESLint ä¼šè‡ªåŠ¨å»æŸ¥æ‰¾ç¼ºå¤±çš„ä¾èµ–ï¼Œæˆ‘ä»¬è¿™é‡Œé€‰æ‹© Yesï¼Œä½¿ç”¨ NPM ä¸‹è½½å®‰è£…è¿™äº›ä¾èµ–åŒ…ã€‚

æ³¨æ„ï¼šå¦‚æœè‡ªåŠ¨å®‰è£…ä¾èµ–å¤±è´¥ï¼Œé‚£ä¹ˆéœ€è¦æ‰‹åŠ¨å®‰è£…

npm i @typescript\-eslint/eslint\-plugin @typescript\-eslint/parser eslint\-config\-airbnb\-base eslint\-plugin\-import eslint\-plugin\-vue \-D

1.  ESLint é…ç½®æ–‡ä»¶ .eslintrc.js

VSCode ä½¿ç”¨ ESLint é…ç½®æ–‡ä»¶éœ€è¦å»æ’ä»¶å¸‚åœºä¸‹è½½æ’ä»¶ ESLint ã€‚

è§£å†³ Prettier å’Œ ESLint çš„å†²çª
------------------------

æœ¬é¡¹ç›®ä¸­çš„ ESLint é…ç½®ä¸­ä½¿ç”¨äº† Airbnb JavaScript é£æ ¼æŒ‡å—æ ¡éªŒï¼Œå…¶è§„åˆ™ä¹‹ä¸€æ˜¯ä»£ç ç»“æŸåé¢è¦åŠ åˆ†å·ï¼Œè€Œæˆ‘ä»¬åœ¨ Prettier é…ç½®æ–‡ä»¶ä¸­åŠ äº†ä»£ç ç»“æŸåé¢ä¸åŠ åˆ†å·çš„é…ç½®é¡¹ï¼Œè¿™æ ·å°±æœ‰å†²çªäº†ï¼Œä¼šå‡ºç°ç”¨ Prettier æ ¼å¼åŒ–åçš„ä»£ç ï¼ŒESLint æ£€æµ‹åˆ°æ ¼å¼æœ‰é—®é¢˜çš„ï¼Œä»è€ŒæŠ›å‡ºé”™è¯¯æç¤ºã€‚ è§£å†³ä¸¤è€…å†²çªé—®é¢˜ï¼Œéœ€è¦ç”¨åˆ° eslint-plugin-prettier å’Œ eslint-config-prettierã€‚

eslint-plugin-prettier å°† Prettier çš„è§„åˆ™è®¾ç½®åˆ° ESLint çš„è§„åˆ™ä¸­ã€‚

eslint-config-prettier å…³é—­ ESLint ä¸­ä¸ Prettier ä¸­ä¼šå‘ç”Ÿå†²çªçš„è§„åˆ™ã€‚

æœ€åå½¢æˆä¼˜å…ˆçº§ï¼šPrettier é…ç½®è§„åˆ™ > ESLint é…ç½®è§„åˆ™ã€‚

å®‰è£…æ’ä»¶

npm i eslint\-plugin\-prettier eslint\-config\-prettier \-D

åœ¨ .eslintrc.js æ·»åŠ  prettier æ’ä»¶

module.exports \= {
  ...
  extends: \[
    'plugin:vue/essential',
    'airbnb-base',
    'plugin:prettier/recommended' // æ·»åŠ  prettier æ’ä»¶
  \],
  ...
}

VSCodeæ€ä¹ˆæ‰“å¼€settings.jsonæ–‡ä»¶
-------------------------

1.  ç‚¹å‡»å·¦ä¸‹è§’é½¿è½®å›¾æ ‡ï¼Œé€‰æ‹©å‘½ä»¤é¢æ¿
2.  åœ¨æœç´¢æ¡†è¾“å…¥ï¼šsettings.json,å¹¶é€‰ä¸­

VSCode åœ¨ settings.json è®¾ç½®æ–‡ä»¶ä¸­ï¼Œå¢åŠ ä»¥ä¸‹ä»£ç ï¼š

{
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
 }
}

é›†æˆ husky å’Œ lint-staged
----------------------

æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­å·²é›†æˆ ESLint å’Œ Prettierï¼Œåœ¨ç¼–ç æ—¶ï¼Œè¿™äº›å·¥å…·å¯ä»¥å¯¹æˆ‘ä»¬å†™çš„ä»£ç è¿›è¡Œå®æ—¶æ ¡éªŒï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šèƒ½æœ‰æ•ˆè§„èŒƒæˆ‘ä»¬å†™çš„ä»£ç ï¼Œä½†å›¢é˜Ÿå¯èƒ½ä¼šæœ‰äº›äººè§‰å¾—è¿™äº›æ¡æ¡æ¡†æ¡†çš„é™åˆ¶å¾ˆéº»çƒ¦ï¼Œé€‰æ‹©è§†â€œæç¤ºâ€è€Œä¸è§ï¼Œä¾æ—§æŒ‰è‡ªå·±çš„ä¸€å¥—é£æ ¼æ¥å†™ä»£ç ï¼Œæˆ–è€…å¹²è„†ç¦ç”¨æ‰è¿™äº›å·¥å…·ï¼Œå¼€å‘å®Œæˆå°±ç›´æ¥æŠŠä»£ç æäº¤åˆ°äº†ä»“åº“ï¼Œæ—¥ç§¯æœˆç´¯ï¼ŒESLint ä¹Ÿå°±å½¢åŒè™šè®¾ã€‚

æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åšä¸€äº›é™åˆ¶ï¼Œè®©æ²¡é€šè¿‡ ESLint æ£€æµ‹å’Œä¿®å¤çš„ä»£ç ç¦æ­¢æäº¤ï¼Œä»è€Œä¿è¯ä»“åº“ä»£ç éƒ½æ˜¯ç¬¦åˆè§„èŒƒçš„ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ° Git Hookï¼Œåœ¨æœ¬åœ°æ‰§è¡Œ git commit çš„æ—¶å€™ï¼Œå°±å¯¹æ‰€æäº¤çš„ä»£ç è¿›è¡Œ ESLint æ£€æµ‹å’Œä¿®å¤ï¼ˆå³æ‰§è¡Œ eslint --fixï¼‰ï¼Œå¦‚æœè¿™äº›ä»£ç æ²¡é€šè¿‡ ESLint è§„åˆ™æ ¡éªŒï¼Œåˆ™ç¦æ­¢æäº¤ã€‚

å®ç°è¿™ä¸€åŠŸèƒ½ï¼Œæˆ‘ä»¬å€ŸåŠ© husky + lint-staged ã€‚

husky â€”â€” Git Hook å·¥å…·ï¼Œå¯ä»¥è®¾ç½®åœ¨ git å„ä¸ªé˜¶æ®µï¼ˆpre-commitã€commit-msgã€pre-push ç­‰ï¼‰è§¦å‘æˆ‘ä»¬çš„å‘½ä»¤ã€‚

lint-staged â€”â€” åœ¨ git æš‚å­˜çš„æ–‡ä»¶ä¸Šè¿è¡Œ lintersã€‚

é…ç½® husky
--------

è‡ªåŠ¨é…ç½®ï¼ˆæ¨èï¼‰

ä½¿ç”¨ husky-init å‘½ä»¤å¿«é€Ÿåœ¨é¡¹ç›®åˆå§‹åŒ–ä¸€ä¸ª husky é…ç½®ã€‚

npx husky\-init && npm install

è¿™è¡Œå‘½ä»¤åšäº†å››ä»¶äº‹ï¼š

1.  å®‰è£… husky åˆ°å¼€å‘ä¾èµ–
2.  åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º .husky ç›®å½•
3.  åœ¨ .husky ç›®å½•åˆ›å»º pre-commit hookï¼Œå¹¶åˆå§‹åŒ– pre-commit å‘½ä»¤ä¸º npm test
4.  ä¿®æ”¹ package.json çš„ scriptsï¼Œå¢åŠ  "prepare": "husky install"

husky åŒ…å«å¾ˆå¤š hookï¼ˆé’©å­ï¼‰ï¼Œå¸¸ç”¨æœ‰ï¼špre-commitã€commit-msgã€pre-pushã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ pre-commit æ¥è§¦å‘ ESLint å‘½ä»¤ã€‚

ä¿®æ”¹ .husky/pre-commit hook æ–‡ä»¶çš„è§¦å‘å‘½ä»¤ï¼š

#!/bin/sh
. "$(dirname "$0")/\_/husky.sh"

eslint \--fix ./src \--ext .vue,.js,.ts

ä¸Šé¢è¿™ä¸ª pre-commit hook æ–‡ä»¶çš„ä½œç”¨æ˜¯ï¼šå½“æˆ‘ä»¬æ‰§è¡Œ git commit -m "xxx" æ—¶ï¼Œä¼šå…ˆå¯¹ src ç›®å½•ä¸‹æ‰€æœ‰çš„ .vueã€.jsã€.ts æ–‡ä»¶æ‰§è¡Œ eslint --fix å‘½ä»¤ï¼Œå¦‚æœ ESLint é€šè¿‡ï¼ŒæˆåŠŸ commitï¼Œå¦åˆ™ç»ˆæ­¢ commitã€‚

ä½†æ˜¯åˆå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šæœ‰æ—¶å€™æˆ‘ä»¬æ˜æ˜åªæ”¹åŠ¨äº†ä¸€ä¸¤ä¸ªæ–‡ä»¶ï¼Œå´è¦å¯¹æ‰€æœ‰çš„æ–‡ä»¶æ‰§è¡Œ eslint --fixã€‚å‡å¦‚è¿™æ˜¯ä¸€ä¸ªå†å²é¡¹ç›®ï¼Œæˆ‘ä»¬åœ¨ä¸­é€”é…ç½®äº† ESLint è§„åˆ™ï¼Œé‚£ä¹ˆåœ¨æäº¤ä»£ç æ—¶ï¼Œä¹Ÿä¼šå¯¹å…¶ä»–æœªä¿®æ”¹çš„â€œå†å²â€æ–‡ä»¶éƒ½è¿›è¡Œæ£€æŸ¥ï¼Œå¯èƒ½ä¼šé€ æˆå¤§é‡æ–‡ä»¶å‡ºç° ESLint é”™è¯¯ï¼Œæ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚

æˆ‘ä»¬è¦åšåˆ°åªç”¨ ESLint ä¿®å¤è‡ªå·±æ­¤æ¬¡å†™çš„ä»£ç ï¼Œè€Œä¸å»å½±å“å…¶ä»–çš„ä»£ç ã€‚æ‰€ä»¥æˆ‘ä»¬è¿˜éœ€å€ŸåŠ©ä¸€ä¸ªç¥å¥‡çš„å·¥å…· lint-staged ã€‚

é…ç½® lint-staged
--------------

lint-staged è¿™ä¸ªå·¥å…·ä¸€èˆ¬ç»“åˆ husky æ¥ä½¿ç”¨ï¼Œå®ƒå¯ä»¥è®© husky çš„ hook è§¦å‘çš„å‘½ä»¤åªä½œç”¨äº git addé‚£äº›æ–‡ä»¶ï¼ˆå³ git æš‚å­˜åŒºçš„æ–‡ä»¶ï¼‰ï¼Œè€Œä¸ä¼šå½±å“åˆ°å…¶ä»–æ–‡ä»¶ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ lint-staged ç»§ç»­ä¼˜åŒ–é¡¹ç›®ã€‚

1.  å®‰è£… lint-staged

npm i lint\-staged \-D

1.  åœ¨ package.jsoné‡Œå¢åŠ  lint-staged é…ç½®é¡¹

åªå¯¹ git æš‚å­˜åŒºçš„ .vueã€.jsã€.ts æ–‡ä»¶æ‰§è¡Œ eslint --fixã€‚

1.  ä¿®æ”¹ .husky/pre-commit hook çš„è§¦å‘å‘½ä»¤ä¸ºï¼šnpx lint-staged

#!/bin/sh
. "$(dirname "$0")/\_/husky.sh"

npx lint\-staged

è‡³æ­¤ï¼Œhusky å’Œ lint-staged ç»„åˆé…ç½®å®Œæˆã€‚

æ— è®ºå†™ä»£ç è¿˜æ˜¯åšå…¶ä»–äº‹æƒ…ï¼Œéƒ½åº”è¯¥ç”¨é•¿è¿œçš„çœ¼å…‰æ¥çœ‹ï¼Œåˆšå¼€å§‹ä½¿ç”¨ ESint çš„æ—¶å€™å¯èƒ½ä¼šæœ‰å¾ˆå¤šé—®é¢˜ï¼Œæ”¹èµ·æ¥ä¹Ÿå¾ˆè´¹æ—¶è´¹åŠ›ï¼Œåªè¦åšæŒä¸‹å»ï¼Œä»£ç è´¨é‡å’Œå¼€å‘æ•ˆç‡éƒ½ä¼šå¾—åˆ°æå‡ï¼Œå‰æœŸçš„ä»˜å‡ºéƒ½æ˜¯å€¼å¾—çš„ã€‚

æäº¤è§„èŒƒ
----

å¦‚æœ git commit çš„æè¿°ä¿¡æ¯ç²¾å‡†ï¼Œåœ¨åæœŸç»´æŠ¤å’Œ Bug å¤„ç†æ—¶ä¼šå˜å¾—æœ‰æ®å¯æŸ¥ï¼Œé¡¹ç›®å¼€å‘å‘¨æœŸå†…è¿˜å¯ä»¥æ ¹æ®è§„èŒƒçš„æäº¤ä¿¡æ¯å¿«é€Ÿç”Ÿæˆå¼€å‘æ—¥å¿—ï¼Œä»è€Œæ–¹ä¾¿æˆ‘ä»¬è¿½è¸ªé¡¹ç›®å’ŒæŠŠæ§è¿›åº¦ã€‚

æäº¤ä¿¡æ¯éƒ½æ˜¯æœ‰å›ºå®šæ ¼å¼çš„

### commit message æ ¼å¼è§„èŒƒ

commit message ç”± Headerã€Bodyã€Footer ç»„æˆã€‚

<Header\>

<Body\>

<Footer\>

Header
------

Header éƒ¨åˆ†åŒ…æ‹¬ä¸‰ä¸ªå­—æ®µ typeï¼ˆå¿…éœ€ï¼‰ã€scopeï¼ˆå¯é€‰ï¼‰å’Œ subjectï¼ˆå¿…éœ€ï¼‰ã€‚

<type\>(<scope\>): <subject\>

### type

type ç”¨äºè¯´æ˜ commit çš„æäº¤ç±»å‹ï¼ˆå¿…é¡»æ˜¯ä»¥ä¸‹å‡ ç§ä¹‹ä¸€ï¼‰ã€‚

feat: æ–°å¢ä¸€ä¸ªåŠŸèƒ½
fix: ä¿®å¤ä¸€ä¸ªBug
docs: æ–‡æ¡£å˜æ›´
style: ä»£ç æ ¼å¼ï¼ˆä¸å½±å“åŠŸèƒ½ï¼Œåˆ—å¦‚ç©ºæ ¼ï¼Œåˆ†å·ç­‰æ ¼å¼ä¿®æ­£ï¼‰
refactor: ä»£ç é‡æ„
perf: æ”¹å–„æ€§èƒ½
test: æµ‹è¯•
build: å˜æ›´é¡¹ç›®æ„å»ºæˆ–å¤–éƒ¨ä¾èµ–ï¼ˆä¾‹å¦‚ï¼šscopes:webpack, gulp, npmç­‰ï¼‰
ci: æ›´æ”¹æŒç»­é›†æˆè½¯ä»¶çš„é…ç½®æ–‡ä»¶å’Œpackageä¸­çš„scriptså‘½ä»¤ï¼Œä¾‹å¦‚ï¼šscopes: Travis, Circleç­‰
chore: å˜æ›´æ„å»ºæµç¨‹æˆ–è¾…åŠ©å·¥å…·
revert: ä»£ç å›é€€

### scope

scope ç”¨äºæŒ‡å®šæœ¬æ¬¡ commit å½±å“çš„èŒƒå›´ã€‚scope ä¾æ®é¡¹ç›®è€Œå®šï¼Œä¾‹å¦‚åœ¨ä¸šåŠ¡é¡¹ç›®ä¸­å¯ä»¥ä¾æ®èœå•æˆ–è€…åŠŸèƒ½æ¨¡å—åˆ’åˆ†ï¼Œå¦‚æœæ˜¯ç»„ä»¶åº“å¼€å‘ï¼Œåˆ™å¯ä»¥ä¾æ®ç»„ä»¶åˆ’åˆ†ã€‚ï¼ˆscope å¯çœç•¥ï¼‰

### subject

subject æ˜¯æœ¬æ¬¡ commit çš„ç®€æ´æè¿°ï¼Œé•¿åº¦çº¦å®šåœ¨ 50 ä¸ªå­—ç¬¦ä»¥å†…ï¼Œé€šå¸¸éµå¾ªä»¥ä¸‹å‡ ä¸ªè§„èŒƒï¼š

-   ç”¨åŠ¨è¯å¼€å¤´ï¼Œç¬¬ä¸€äººç§°ç°åœ¨æ—¶è¡¨è¿°ï¼Œä¾‹å¦‚ï¼šchange ä»£æ›¿ changed æˆ– changes
-   ç¬¬ä¸€ä¸ªå­—æ¯å°å†™
-   ç»“å°¾ä¸åŠ å¥å·ï¼ˆ.ï¼‰

Body
----

body æ˜¯å¯¹æœ¬æ¬¡ commit çš„è¯¦ç»†æè¿°ï¼Œå¯ä»¥åˆ†æˆå¤šè¡Œã€‚ï¼ˆbody å¯çœç•¥ï¼‰

è·Ÿ subject ç±»ä¼¼ï¼Œç”¨åŠ¨è¯å¼€å¤´ï¼Œbody åº”è¯¥è¯´æ˜ä¿®æ”¹çš„åŸå› å’Œæ›´æ”¹å‰åçš„è¡Œä¸ºå¯¹æ¯”ã€‚

Footer
------

å¦‚æœæœ¬æ¬¡æäº¤çš„ä»£ç æ˜¯çªç ´æ€§çš„å˜æ›´æˆ–å…³é—­ç¼ºé™·ï¼Œåˆ™ Footer å¿…éœ€ï¼Œå¦åˆ™å¯ä»¥çœç•¥ã€‚

-   çªç ´æ€§çš„å˜æ›´

å½“å‰ä»£ç ä¸ä¸Šä¸€ä¸ªç‰ˆæœ¬æœ‰çªç ´æ€§æ”¹å˜ï¼Œåˆ™ Footer ä»¥ BREAKING CHANGE å¼€å¤´ï¼Œåé¢æ˜¯å¯¹å˜åŠ¨çš„æè¿°ã€ä»¥åŠå˜åŠ¨çš„ç†ç”±ã€‚

-   å…³é—­ç¼ºé™·

å¦‚æœå½“å‰æäº¤æ˜¯é’ˆå¯¹ç‰¹å®šçš„ issueï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ Footer éƒ¨åˆ†å¡«å†™éœ€è¦å…³é—­çš„å•ä¸ª issue æˆ–ä¸€ç³»åˆ— issuesã€‚

å‚è€ƒä¾‹å­
----

-   feat

feat(browser): onUrlChange event (popstate/hashchange/polling)

Added new event to browser:
\- forward popstate event if available
\- forward hashchange event if popstate not available
\- do polling when neither popstate nor hashchange available

Breaks $browser.onHashChange, which was removed (use onUrlChange instead)

-   fix

fix(compile): couple of unit tests for IE9

Older IEs serialize html uppercased, but IE9 does not...
Would be better to expect case insensitive, unfortunately jasmine does
not allow to user regexps for throw expectations.

Closes #392
Breaks foo.bar api, foo.baz should be used instead

-   style

style(location): add couple of missing semi colons

-   chore

chore(release): v3.4.2

è§„èŒƒ commit message çš„å¥½å¤„
---------------------

1.  é¦–è¡Œå°±æ˜¯ç®€æ´å®ç”¨çš„å…³é”®ä¿¡æ¯ï¼Œæ–¹ä¾¿åœ¨ git history ä¸­å¿«é€Ÿæµè§ˆã€‚
2.  å…·æœ‰æ›´åŠ è¯¦ç»†çš„ body å’Œ footerï¼Œå¯ä»¥æ¸…æ™°çš„çœ‹å‡ºæŸæ¬¡æäº¤çš„ç›®çš„å’Œå½±å“ã€‚
3.  å¯ä»¥é€šè¿‡ type è¿‡æ»¤å‡ºæƒ³è¦æŸ¥æ‰¾çš„ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å…³é”®å­—å¿«é€ŸæŸ¥æ‰¾ç›¸å…³æäº¤ã€‚
4.  å¯ä»¥ç›´æ¥ä» commit ç”Ÿæˆ change logã€‚

é›†æˆ Commitizen å®ç°è§„èŒƒæäº¤
--------------------

Commitizen æ˜¯ä¸€ä¸ªå¸®åŠ©æ’°å†™è§„èŒƒ commit message çš„å·¥å…·ã€‚å®ƒæœ‰ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…· cz-cliã€‚

å®‰è£… Commitizen
-------------

npm install commitizen \-D

åˆå§‹åŒ–é¡¹ç›®
-----

æˆåŠŸå®‰è£… Commitizen åï¼Œæˆ‘ä»¬ç”¨ cz-conventional-changelog é€‚é…å™¨æ¥åˆå§‹åŒ–é¡¹ç›®ï¼š

npx commitizen init cz\-conventional\-changelog \--save\-dev \--save\-exact

è¿™è¡Œå‘½ä»¤åšäº†ä¸¤ä»¶äº‹ï¼š

-   å®‰è£… cz-conventional-changelog åˆ°å¼€å‘ä¾èµ–ï¼ˆdevDependenciesï¼‰
-   åœ¨ package.json ä¸­å¢åŠ äº† config.commitizen

"config": {
  "commitizen": {
    "path": "./node\_modules/cz-conventional-changelog"
  }
}

ä½¿ç”¨ Commitizen
-------------

ä»¥å‰æˆ‘ä»¬æäº¤ä»£ç éƒ½æ˜¯ git commit -m "xxx"ï¼Œç°åœ¨æ”¹ä¸º git czï¼Œç„¶åæŒ‰ç…§ç»ˆç«¯æ“ä½œæç¤ºï¼Œé€æ­¥å¡«å…¥ä¿¡æ¯ï¼Œå°±èƒ½è‡ªåŠ¨ç”Ÿæˆè§„èŒƒçš„ commit messageã€‚

æœ€åï¼Œåœ¨ Git æäº¤å†å²ä¸­å°±èƒ½çœ‹åˆ°åˆšåˆšè§„èŒƒçš„æäº¤è®°å½•äº†.

è‡ªå®šä¹‰é…ç½®æäº¤è¯´æ˜
---------

ä»ä¸Šé¢çš„æˆªå›¾å¯ä»¥çœ‹åˆ°ï¼Œgit cz ç»ˆç«¯æ“ä½œæç¤ºéƒ½æ˜¯è‹±æ–‡çš„ï¼Œå¦‚æœæƒ³æ”¹æˆä¸­æ–‡çš„æˆ–è€…è‡ªå®šä¹‰è¿™äº›é…ç½®é€‰é¡¹ï¼Œæˆ‘ä»¬ä½¿ç”¨ cz-customizable é€‚é…å™¨ã€‚

cz-customizable åˆå§‹åŒ–é¡¹ç›®
---------------------

è¿è¡Œå¦‚ä¸‹å‘½ä»¤ä½¿ç”¨ cz-customizable åˆå§‹åŒ–é¡¹ç›®ï¼Œæ³¨æ„ä¹‹å‰å·²ç»åˆå§‹åŒ–è¿‡ä¸€æ¬¡ï¼Œè¿™æ¬¡å†åˆå§‹åŒ–ï¼Œéœ€è¦åŠ  --force è¦†ç›–ã€‚

npx commitizen init cz\-customizable \--save\-dev \--save\-exact \--force

è¿™è¡Œå‘½ä»¤åšäº†ä¸¤ä»¶äº‹ï¼š

å®‰è£… cz-customizable åˆ°å¼€å‘ä¾èµ–ï¼ˆdevDependenciesï¼‰

"devDependencies": {
  ...
  "cz-customizable": "^6.3.0",
  ...
},

ä¿®æ”¹ package.json ä¸­çš„ config.commitizen å­—æ®µä¸ºï¼š

"config": {
  "commitizen": {
    "path": "./node\_modules/cz-customizable"
  }
}

ä½¿ç”¨ cz-customizable
------------------

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º .cz-config.js æ–‡ä»¶

é›†æˆ commitlint éªŒè¯æäº¤è§„èŒƒ
--------------------

åœ¨â€œä»£ç è§„èŒƒâ€ç« èŠ‚ï¼Œæˆ‘ä»¬å·²ç»è®²åˆ°è¿‡ï¼Œå°½ç®¡åˆ¶å®šäº†è§„èŒƒï¼Œä½†åœ¨å¤šäººåä½œçš„é¡¹ç›®ä¸­ï¼Œæ€»æœ‰äº›äººä¾æ—§æˆ‘è¡Œæˆ‘ç´ ï¼Œå› æ­¤æäº¤ä»£ç è¿™ä¸ªç¯èŠ‚ï¼Œæˆ‘ä»¬ä¹Ÿå¢åŠ ä¸€ä¸ªé™åˆ¶ï¼šåªè®©ç¬¦åˆ Angular è§„èŒƒçš„ commit message é€šè¿‡ï¼Œæˆ‘ä»¬å€ŸåŠ© @commitlint/config-conventional å’Œ @commitlint/cli æ¥å®ç°ã€‚

å®‰è£… commitlint
-------------

å®‰è£… @commitlint/config-conventional å’Œ @commitlint/cli

npm i @commitlint/config\-conventional @commitlint/cli \-D

é…ç½® commitlint
-------------

åˆ›å»º commitlint.config.js æ–‡ä»¶
--------------------------

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º commitlint.config.js æ–‡ä»¶ï¼Œå¹¶å¡«å…¥ä»¥ä¸‹å†…å®¹ï¼š

module.exports \= { extends: \['@commitlint/config-conventional'\] }

ä½¿ç”¨ husky çš„ commit-msg hook è§¦å‘éªŒè¯æäº¤ä¿¡æ¯çš„å‘½ä»¤

æˆ‘ä»¬ä½¿ç”¨ husky å‘½ä»¤åœ¨ .husky ç›®å½•ä¸‹åˆ›å»º commit-msg æ–‡ä»¶ï¼Œå¹¶åœ¨æ­¤æ‰§è¡Œ commit message çš„éªŒè¯å‘½ä»¤ã€‚

commitlint éªŒè¯
-------------

ä¸ç¬¦åˆè§„èŒƒçš„æäº¤ä¿¡æ¯

æäº¤ä¿¡æ¯ test commitlint ä¸ç¬¦åˆè§„èŒƒï¼Œæäº¤å¤±è´¥ã€‚

ç¬¦åˆè§„èŒƒçš„æäº¤ä¿¡æ¯

æäº¤ä¿¡æ¯ test: commitlint test ç¬¦åˆè§„èŒƒï¼ŒæˆåŠŸæäº¤åˆ°ä»“åº“ã€‚

å› ä¸ºå·²åœ¨é¡¹ç›®ä¸­é›†æˆ commitizenï¼Œå»ºè®®å¤§å®¶ç”¨ git cz æ¥ä»£æ›¿ git commit æäº¤ä»£ç ï¼Œå¯ä»¥ä¿è¯æäº¤ä¿¡æ¯è§„èŒƒã€‚

å•å…ƒæµ‹è¯•
----

å•å…ƒæµ‹è¯•æ˜¯é¡¹ç›®å¼€å‘ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„ç¯èŠ‚ï¼Œå®Œæ•´çš„æµ‹è¯•èƒ½ä¸ºä»£ç å’Œä¸šåŠ¡æä¾›è´¨é‡ä¿è¯ï¼Œå‡å°‘ Bug çš„å‡ºç°ã€‚

å®‰è£…æ ¸å¿ƒä¾èµ–
------

æˆ‘ä»¬ä½¿ç”¨ Vue å®˜æ–¹æä¾›çš„ vue-test-utils å’Œç¤¾åŒºæµè¡Œçš„æµ‹è¯•å·¥å…· jest æ¥è¿›è¡Œ Vue ç»„ä»¶çš„å•å…ƒæµ‹è¯•ã€‚

-   vue-test-utils The next iteration of Vue Test Utils. It targets Vue 3.
-   jest Delightful JavaScript Testing.
-   vue-jest Jest Vue transformer
-   ts-jest A Jest transformer with source map support that lets you use Jest to test projects written in TypeScript.

å®‰è£…è¿™äº›å·¥å…·ä¸ºå¼€å‘ä¾èµ–ï¼ˆdevDependenciesï¼‰ï¼š

npm i @vue/test\-utils@next jest vue\-jest@next ts\-jest \-D

åˆ›å»º jest é…ç½®æ–‡ä»¶
------------

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»º jest.config.js æ–‡ä»¶ï¼š

åˆ›å»ºå•å…ƒæµ‹è¯•æ–‡ä»¶
--------

åœ¨ä¸Šé¢çš„ `jest.config.js` æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬é…ç½®åªåŒ¹é… `__tests__` ç›®å½•ä¸‹çš„ä»»æ„ .ts æ–‡ä»¶æˆ–å…¶ä»–ç›®å½•ä¸‹çš„ `xx.test.ts/xx.spec.ts` æ–‡ä»¶è¿›è¡Œå•å…ƒæµ‹è¯•ã€‚

è¿™é‡Œï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º `tests` ç›®å½•æ¥å­˜å‚¨å•å…ƒæµ‹è¯•æ–‡ä»¶

â”œâ”€â”€ src/
â””â”€â”€ tests/                           // å•å…ƒæµ‹è¯•ç›®å½•
    â”œâ”€â”€ Test.spec.ts                 // Test ç»„ä»¶æµ‹è¯•

é›†æˆ @types/jest
--------------

ä½¿ç”¨ VSCode / WebStrom / IDEA ç­‰ç¼–è¾‘å™¨æ—¶ï¼Œåœ¨å•å…ƒæµ‹è¯•æ–‡ä»¶ä¸­ï¼ŒIDE ä¼šæç¤ºæŸäº›æ–¹æ³•ä¸å­˜åœ¨ï¼ˆå¦‚ testã€describeã€itã€expectç­‰ï¼‰ï¼Œå®‰è£… @types/jest å³å¯è§£å†³ã€‚

npm i @types/jest \-D

TypeScript çš„ç¼–è¯‘å™¨ä¹Ÿä¼šæç¤º jest çš„æ–¹æ³•å’Œç±»å‹æ‰¾ä¸åˆ°ï¼Œæˆ‘ä»¬è¿˜éœ€æŠŠ @types/jest æ·»åŠ æ ¹ç›®å½•ä¸‹çš„ ts.config.jsonï¼ˆTypeScript é…ç½®æ–‡ä»¶ï¼‰ä¸­ï¼š

{
  "compilerOptions": {
    ...
    "types": \["vite/client", "jest"\]
  },
}

æ·»åŠ  eslint-plugin-jest
---------------------

å› ä¸ºæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­é›†æˆäº† ESLintï¼Œå¦‚ä¸Šå›¾å¾ˆæ˜æ˜¾æ˜¯æ²¡é€šè¿‡ ESLint è§„åˆ™æ£€éªŒã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨ ESLint ä¸­å¢åŠ  eslint-plugin-jest æ’ä»¶æ¥è§£é™¤å¯¹ jest çš„æ ¡éªŒã€‚

å®‰è£… eslint-plugin-jest

npm i eslint\-plugin\-jest \-D

æ·»åŠ  eslint-plugin-jest åˆ° ESLint é…ç½®æ–‡ä»¶ .eslintrc.js ä¸­

module.exports \= {
  ...
  extends: \[
    ...
    'plugin:jest/recommended'
  \],
  ...
}

ç°åœ¨ï¼Œæˆ‘ä»¬çš„å•å…ƒæµ‹è¯•ä»£ç å°±ä¸ä¼šæœ‰é”™è¯¯æç¤ºä¿¡æ¯äº†

æ‰§è¡Œå•å…ƒæµ‹è¯•
------

åœ¨æ ¹ç›®å½•ä¸‹ package.json æ–‡ä»¶çš„ scripts ä¸­ï¼Œæ·»åŠ ä¸€æ¡å•å…ƒæµ‹è¯•å‘½ä»¤ï¼š "test": "jest"ã€‚

æ‰§è¡Œå‘½ä»¤ npm run test å³å¯è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œjest ä¼šæ ¹æ® jest.config.js é…ç½®æ–‡ä»¶å»æŸ¥æ‰¾ `__tests__` ç›®å½•ä¸‹çš„ .ts æ–‡ä»¶æˆ–å…¶ä»–ä»»æ„ç›®å½•ä¸‹çš„ .spec.ts å’Œ .test.ts æ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œå•å…ƒæµ‹è¯•æ–¹æ³•ã€‚

ä½ å¯ä»¥åœ¨ jest.config.js é…ç½®æ–‡ä»¶ä¸­ï¼Œè‡ªç”±é…ç½®å•å…ƒæµ‹è¯•æ–‡ä»¶çš„ç›®å½•ã€‚

å½“å•å…ƒæµ‹è¯•æ²¡æœ‰å…¨éƒ¨é€šè¿‡æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®æŠ¥é”™ä¿¡æ¯å»ä¼˜åŒ–å¯¹åº”ç»„ä»¶çš„ä»£ç ï¼Œè¿›ä¸€æ­¥æé«˜é¡¹ç›®å¥å£®æ€§ã€‚ä½†æ˜¯å†™å•å…ƒæµ‹è¯•æ˜¯ä»¶æ¯”è¾ƒç—›è‹¦çš„äº‹ï¼Œæˆ‘ä¸ªäººè§‰å¾—ä¹Ÿæ²¡å¿…è¦å…¨éƒ¨ç»„ä»¶éƒ½å†™å•å…ƒæµ‹è¯•ï¼Œæ ¹æ®é¡¹ç›®å®é™…æƒ…å†µæœ‰é’ˆå¯¹æ€§å»å†™å°±è¡Œäº†ã€‚

å•å…ƒæµ‹è¯•çº¦æŸ
------

å‰é¢ï¼Œæˆ‘ä»¬ä½¿ç”¨ husky åœ¨ Git çš„ pre-commit å’Œ commit-msg é˜¶æ®µåˆ†åˆ«çº¦æŸä»£ç é£æ ¼è§„èŒƒå’Œæäº¤ä¿¡æ¯è§„èŒƒã€‚è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬åœ¨ pre-push é˜¶æ®µè¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œåªæœ‰å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡æ‰è®©ä»£ç  push åˆ°è¿œç«¯ä»“åº“ï¼Œå¦åˆ™ç»ˆæ­¢ pushã€‚

ä½¿ç”¨ husky å‘½ä»¤åœ¨ .husky ç›®å½•ä¸‹è‡ªåŠ¨åˆ›å»º pre-push hook æ–‡ä»¶ï¼Œå¹¶åœ¨æ­¤æ‰§è¡Œå•å…ƒæµ‹è¯•å‘½ä»¤ npm run testã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨ git push æ—¶å°±èƒ½å…ˆè¿›è¡Œå•å…ƒæµ‹è¯•äº†ï¼Œåªæœ‰å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼Œæ‰èƒ½æˆåŠŸ pushã€‚

è‡ªåŠ¨éƒ¨ç½²
----

åœ¨é¡¹ç›®ä¸­é›†æˆä»£ç è§„èŒƒçº¦æŸã€æäº¤ä¿¡æ¯è§„èŒƒçº¦æŸï¼Œå•å…ƒæµ‹è¯•çº¦æŸï¼Œä»è€Œä¿è¯æˆ‘ä»¬è¿œç«¯ä»“åº“ï¼ˆå¦‚ GitHubã€GitLabã€Gitee ä»“åº“ç­‰ï¼‰çš„ä»£ç éƒ½æ˜¯é«˜è´¨é‡çš„ã€‚

ä½¿ç”¨ CIï¼ˆContinuous Integration æŒç»­é›†æˆï¼‰æ¥å®Œæˆé¡¹ç›®æœ€åçš„éƒ¨ç½²å·¥ä½œã€‚

å¸¸è§çš„ CI å·¥å…·æœ‰ GitHub Actionsã€GitLab CIã€Travis CIã€Circle CI ç­‰ã€‚

è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ GitHub Actionsã€‚

ä»€ä¹ˆæ˜¯ GitHub Actions
------------------

GitHub Actions æ˜¯ GitHub çš„æŒç»­é›†æˆæœåŠ¡ï¼ŒæŒç»­é›†æˆç”±å¾ˆå¤šæ“ä½œç»„æˆï¼Œæ¯”å¦‚æŠ“å–ä»£ç ã€è¿è¡Œæµ‹è¯•ã€ç™»å½•è¿œç¨‹æœåŠ¡å™¨ã€å‘å¸ƒåˆ°ç¬¬ä¸‰æ–¹æœåŠ¡ç­‰ç­‰ï¼ŒGitHub æŠŠè¿™äº›æ“ä½œç§°ä¸º actionsã€‚

é…ç½® GitHub Actions
-----------------

å…¶ä¸­ï¼Œæˆ‘ä»¬ç”¨ï¼š

-   master åˆ†æ”¯å­˜å‚¨é¡¹ç›®æºä»£ç 
-   gh-pages åˆ†æ”¯å­˜å‚¨æ‰“åŒ…åçš„é™æ€æ–‡ä»¶

gh-pages åˆ†æ”¯ï¼Œæ˜¯ GitHub Pages æœåŠ¡çš„å›ºå®šåˆ†æ”¯ï¼Œå¯ä»¥é€šè¿‡ HTTP çš„æ–¹å¼è®¿é—®åˆ°è¿™ä¸ªåˆ†æ”¯çš„é™æ€æ–‡ä»¶èµ„æºã€‚

åˆ›å»º GitHub Token
---------------

åˆ›å»ºä¸€ä¸ªæœ‰ repo å’Œ workflow æƒé™çš„ GitHub Token

æ³¨æ„ï¼šæ–°ç”Ÿæˆçš„ Token åªä¼šæ˜¾ç¤ºä¸€æ¬¡ï¼Œä¿å­˜èµ·æ¥ï¼Œåé¢è¦ç”¨åˆ°ã€‚å¦‚æœ‰é—å¤±ï¼Œé‡æ–°ç”Ÿæˆå³å¯ã€‚

åœ¨ä»“åº“ä¸­æ·»åŠ  secret
-------------

æ–°åˆ›å»ºçš„ Token æ·»åŠ åˆ° GitHub ä»“åº“çš„ Secrets é‡Œï¼Œå¹¶å°†è¿™ä¸ªæ–°å¢çš„ secret å‘½åä¸º VUE3\_DEPLOY ï¼ˆåå­—æ— æ‰€è°“ï¼Œçœ‹ä½ å–œæ¬¢ï¼‰ã€‚

æ­¥éª¤ï¼šä»“åº“ -> settings -> Secrets -> New repository secretã€‚

æ–°åˆ›å»ºçš„ secret VUE3\_DEPLOY åœ¨ Actions é…ç½®æ–‡ä»¶ä¸­è¦ç”¨åˆ°ï¼Œä¸¤ä¸ªåœ°æ–¹éœ€ä¿æŒä¸€è‡´ï¼

åˆ›å»º Actions é…ç½®æ–‡ä»¶
---------------

-   åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º .github ç›®å½•ã€‚
-   åœ¨ .github ç›®å½•ä¸‹åˆ›å»º workflows ç›®å½•ã€‚
-   åœ¨ workflows ç›®å½•ä¸‹åˆ›å»º deploy.yml æ–‡ä»¶ã€‚

è‡ªåŠ¨éƒ¨ç½²è§¦å‘åŸç†
--------

å½“æœ‰æ–°æäº¤çš„ä»£ç  push åˆ° GitHub ä»“åº“æ—¶ï¼Œå°±ä¼šè§¦å‘ GitHub Actionsï¼Œåœ¨ GitHub æœåŠ¡å™¨ä¸Šæ‰§è¡Œ Action é…ç½®æ–‡ä»¶é‡Œé¢çš„å‘½ä»¤ï¼Œä¾‹å¦‚ï¼šå®‰è£…ä¾èµ–ã€é¡¹ç›®æ‰“åŒ…ç­‰ï¼Œç„¶åå°†æ‰“åŒ…å¥½çš„é™æ€æ–‡ä»¶éƒ¨ç½²åˆ° GitHub Pages ä¸Šï¼Œæœ€åï¼Œæˆ‘ä»¬å°±èƒ½é€šè¿‡åŸŸåè®¿é—®äº†ã€‚

https://github.com/settings/tokens/new
